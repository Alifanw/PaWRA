<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="900" viewBox="0 0 1200 900">
  <style>
    .module { fill: #f7f9fb; stroke: #cbd5e1; stroke-width: 2 }
    .entity { fill: #ffffff; stroke: #334155; stroke-width: 1.5 }
    .title { font: bold 14px sans-serif; fill: #0f172a }
    .col { font: 12px monospace; fill: #0f172a }
    .note { font: 11px sans-serif; fill: #475569 }
    .fk { stroke: #0ea5a6; stroke-width: 1.2; marker-end: url(#arrow) }
  </style>

  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 z" fill="#0ea5a6"/>
    </marker>
  </defs>

  <!-- Modules boxes -->
  <rect x="30" y="20" width="350" height="250" class="module"/>
  <text x="45" y="40" class="title">Security Module</text>

  <rect x="420" y="20" width="350" height="250" class="module"/>
  <text x="435" y="40" class="title">Attendance Module</text>

  <rect x="30" y="300" width="350" height="220" class="module"/>
  <text x="45" y="320" class="title">Hospitality Module</text>

  <rect x="420" y="300" width="350" height="220" class="module"/>
  <text x="435" y="320" class="title">Ticketing Module</text>

  <!-- Entities: Security -->
  <rect x="50" y="60" width="300" height="90" class="entity"/>
  <text x="60" y="80" class="title">users</text>
  <text x="60" y="100" class="col">id PK</text>
  <text x="150" y="100" class="col">employee_id FK? -> employees.id (RESTRICT)</text>
  <text x="60" y="118" class="col">email, password, username, is_block</text>

  <rect x="50" y="160" width="300" height="60" class="entity"/>
  <text x="60" y="180" class="title">roles</text>
  <text x="60" y="198" class="col">id PK, name, slug</text>

  <rect x="50" y="230" width="300" height="60" class="entity"/>
  <text x="60" y="250" class="title">permissions</text>
  <text x="60" y="268" class="col">id PK, name, slug</text>

  <rect x="200" y="200" width="140" height="60" class="entity"/>
  <text x="210" y="220" class="title">role_user</text>
  <text x="210" y="238" class="col">user_id FK -> users.id</text>
  <text x="210" y="256" class="col">role_id FK -> roles.id</text>

  <rect x="200" y="260" width="140" height="60" class="entity"/>
  <text x="210" y="280" class="title">permission_role</text>
  <text x="210" y="298" class="col">role_id FK -> roles.id</text>
  <text x="210" y="316" class="col">permission_id FK -> permissions.id</text>

  <!-- Entities: Attendance -->
  <rect x="440" y="60" width="300" height="80" class="entity"/>
  <text x="450" y="80" class="title">employees</text>
  <text x="450" y="100" class="col">id PK, code, name, is_active</text>

  <rect x="440" y="150" width="300" height="70" class="entity"/>
  <text x="450" y="170" class="title">attendance_logs</text>
  <text x="450" y="190" class="col">id PK, employee_id FK -> employees.id (RESTRICT), status, event_time</text>

  <rect x="440" y="230" width="300" height="70" class="entity"/>
  <text x="450" y="250" class="title">rfid_logs</text>
  <text x="450" y="270" class="col">id PK, rfid_code, employee_id FK -> employees.id (RESTRICT), device_code</text>

  <!-- Entities: Doors in Security (door_events) -->
  <rect x="50" y="360" width="300" height="70" class="entity"/>
  <text x="60" y="380" class="title">doors</text>
  <text x="60" y="400" class="col">id PK, name, location</text>

  <rect x="50" y="440" width="300" height="70" class="entity"/>
  <text x="60" y="460" class="title">door_events</text>
  <text x="60" y="480" class="col">id PK, door_id FK -> doors.id, user_id FK -> users.id (CASCADE), event_type, event_time</text>

  <!-- Hospitality & Ticketing placeholders -->
  <rect x="50" y="520" width="320" height="120" class="entity"/>
  <text x="60" y="540" class="title">bookings / booking_units</text>
  <text x="60" y="560" class="col">booking_id PK, unit_id, customer_id, status</text>

  <rect x="440" y="520" width="320" height="120" class="entity"/>
  <text x="450" y="540" class="title">tickets / ticket_sales</text>
  <text x="450" y="560" class="col">sale_id PK, product_id, cashier_id -> users.id</text>

  <!-- Relationship arrows -->
  <line x1="200" y1="110" x2="440" y2="110" class="fk" />
  <text x="330" y="100" class="note">users.employee_id → employees.id (RESTRICT)</text>

  <line x1="160" y1="190" x2="200" y2="210" class="fk" />
  <text x="120" y="200" class="note">roles ↔ role_user ↔ users</text>

  <line x1="160" y1="250" x2="240" y2="280" class="fk" />
  <text x="110" y="260" class="note">permissions ↔ permission_role ↔ roles</text>

  <line x1="200" y1="310" x2="520" y2="160" class="fk" />
  <text x="360" y="230" class="note">permission checks apply per module</text>

  <line x1="180" y1="470" x2="200" y2="310" class="fk" />
  <text x="220" y="390" class="note">door_events.user_id → users.id (CASCADE)</text>

  <line x1="570" y1="220" x2="570" y2="300" class="fk" />
  <text x="590" y="248" class="note">attendance/rfid → employees (RESTRICT)</text>

  <!-- Legend -->
  <rect x="790" y="40" width="360" height="160" fill="#ffffff" stroke="#cbd5e1" />
  <text x="805" y="60" class="title">Legend & Rules</text>
  <text x="805" y="85" class="note">• users.employee_id → employees.id (ON DELETE RESTRICT)</text>
  <text x="805" y="105" class="note">• door_events.user_id → users.id (ON DELETE CASCADE)</text>
  <text x="805" y="125" class="note">• attendance_logs & rfid_logs employee_id → employees.id (ON DELETE RESTRICT)</text>
  <text x="805" y="145" class="note">• role_user & permission_role: pivots (cascade deletes)</text>

</svg>
